   ext4: only use i_size_high for regular files
   
   Directories are not allowed to be bigger than 2GB, so don't use
   i_size_high for anything other than regular files.  E2fsck should
   complain about these inodes, but the simplest thing to do for the
   kernel is to only use i_size_high for regular files.
   
   This prevents an intentially corrupted filesystem from causing the
   kernel to burn a huge amount of CPU and issuing error messages such
   as:
   
   EXT4-fs warning (device loop0): ext4_block_to_path: block 135090028 > max
   
   Thanks to David Maciejak from Fortinet's FortiGuard Global Security
   Research Team for reporting this issue.
   
   http://bugzilla.kernel.org/show_bug.cgi?id=12375
   
   Signed-off-by: "Theodore Ts'o" <tytso@mit.edu>
   Cc: stable@kernel.org

static inline loff_t ext4_isize(struct ext4_inode *raw_inode)
{
	return ((loff_t)le32_to_cpu(raw_inode->i_size_high) << 32) |
		le32_to_cpu(raw_inode->i_size_lo);
}

static inline void ext4_isize_set(struct ext4_inode *raw_inode, loff_t i_size)
		final = ptrs;
	} else {
		ext4_warning(inode->i_sb, "ext4_block_to_path",
				"block %lu > max",
				i_block + direct_blocks +
				indirect_blocks + double_blocks);
	}
	if (boundary)
		*boundary = final - 1 - (i_block & (ptrs - 1));
