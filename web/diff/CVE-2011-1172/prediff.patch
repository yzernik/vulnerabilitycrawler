   ipv6: netfilter: ip6_tables: fix infoleak to userspace
   
   Structures ip6t_replace, compat_ip6t_replace, and xt_get_revision are
   copied from userspace.  Fields of these structs that are
   zero-terminated strings are not checked.  When they are used as argument
   to a format string containing "%s" in request_module(), some sensitive
   information is leaked to userspace via argument of spawned modprobe
   process.
   
   The first bug was introduced before the git epoch;  the second was
   introduced in 3bc3fe5e (v2.6.25-rc1);  the third is introduced by
   6b7d31fc (v2.6.15-rc1).  To trigger the bug one should have
   CAP_NET_ADMIN.
   
   Signed-off-by: Vasiliy Kulikov <segoon@openwall.com>
   Signed-off-by: Patrick McHardy <kaber@trash.net>
	/* overflow check */
	if (tmp.num_counters >= INT_MAX / sizeof(struct xt_counters))
		return -ENOMEM;

	newinfo = xt_alloc_table_info(tmp.size);
	if (!newinfo)
		return -ENOMEM;
	if (tmp.num_counters >= INT_MAX / sizeof(struct xt_counters))
		return -ENOMEM;

	newinfo = xt_alloc_table_info(tmp.size);
	if (!newinfo)
			ret = -EFAULT;
			break;
		}

		if (cmd == IP6T_SO_GET_REVISION_TARGET)
			target = 1;
