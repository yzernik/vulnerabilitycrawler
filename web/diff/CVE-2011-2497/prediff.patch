   Bluetooth: Prevent buffer overflow in l2cap config request
   
   A remote user can provide a small value for the command size field in
   the command header of an l2cap configuration request, resulting in an
   integer underflow when subtracting the size of the configuration request
   header.  This results in copying a very large amount of data via
   memcpy() and destroying the kernel heap.  Check for underflow.
   
   Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com>
   Cc: stable <stable@kernel.org>
   Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>

	/* Reject if config buffer is too small. */
	len = cmd_len - sizeof(*req);
	if (chan->conf_len + len > sizeof(chan->conf_req)) {
		l2cap_send_cmd(conn, cmd->ident, L2CAP_CONF_RSP,
				l2cap_build_conf_rsp(chan, rsp,
					L2CAP_CONF_REJECT, flags), rsp);
