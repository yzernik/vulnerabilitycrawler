commit d93fa011d713100775cd3ac88c468b6830d48877
Author: Caol√°n McNamara <caolanm@redhat.com>
Date:   Wed Apr 6 21:37:47 2011 +0100

    avoid possibility of accessing out of range ObjTimes

diff --git a/lotuswordpro/source/filter/lwpidxmgr.hxx b/lotuswordpro/source/filter/lwpidxmgr.hxx
index 54b88d8..9fa6074 100644
--- a/lotuswordpro/source/filter/lwpidxmgr.hxx
+++ b/lotuswordpro/source/filter/lwpidxmgr.hxx
@@ -112,7 +112,7 @@ protected:
 public:
     void Read( LwpSvStream *pStrm );
     sal_uInt32 GetObjOffset( LwpObjectID objid );
-    sal_uInt32 GetObjTime( sal_uInt16 index ) { return m_TimeTable[index-1]; }
+    sal_uInt32 GetObjTime( sal_uInt16 index ) { return m_TimeTable.at(index-1); }
 };
 #endif
 
diff --git a/lotuswordpro/source/filter/lwpobjid.cxx b/lotuswordpro/source/filter/lwpobjid.cxx
index 61d99b4..0a76504 100644
--- a/lotuswordpro/source/filter/lwpobjid.cxx
+++ b/lotuswordpro/source/filter/lwpobjid.cxx
@@ -148,11 +148,11 @@ sal_uInt32 LwpObjectID::ReadIndexed(LwpObjectStream *pStrm)
         LwpGlobalMgr* pGlobal = LwpGlobalMgr::GetInstance();
         LwpObjectFactory* pFactory = pGlobal->GetLwpObjFactory();
         LwpIndexManager* pIdxMgr = pFactory->GetIndexManager();
-        m_nLow =  pIdxMgr->GetObjTime( (sal_uInt16)m_nIndex);
+        m_nLow = pIdxMgr->GetObjTime( (sal_uInt16)m_nIndex);
     }
     else
     {
-         pStrm->QuickRead(&m_nLow, sizeof(m_nLow));
+        pStrm->QuickRead(&m_nLow, sizeof(m_nLow));
     }
     pStrm->QuickRead(&m_nHigh, sizeof(m_nHigh));
     return DiskSizeIndexed();
